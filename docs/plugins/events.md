# Overview

Subble communicates with plugins and external applications using a event based system. Every action emits an event that can be consumed by third parties.

An event has the following properties:

- ID: a unique ID generated by the host
- Type: event type
- Source: the source name that generated the event
- Timestamp: Date and time of when the event was emitted
- Payload: Extra data associated to event

# Consuming Events

A plugin can consume any event by subscribing to it from the `ISubbleHost`

In the following example we create a simple plugin that every time a log entry is created, increments a variable:

```c#
public class LogCountPlugin : ISubblePlugin
{
    public IPluginInfo Info => new MyPluginInfo();
    public SemVersion Version => (0, 1, 0);
    public long LoadPriority => 99;
    public IEnumerable<Dependency> Dependencies
        => new List<Dependency>();

    public bool Initialize(ISubbleHost host)
    {
        host.Events
            .Where(e => e.Type == EventsType.Core.LOG)
            .Subscribe(OnNewLogEntry);
    }

    private static int _count = 0;
    private static void OnNewLogEntry(ISubbleEvent e)
    {
        _count++;
    }
}
```

# Producing Events

A Plugin can also create events, by calling the method `EmitEvent` from `ISubbleHost`

Continuing the last example we can modify it to emit a event when the count reach 10:

```c#
public class LogCountPlugin : ISubblePlugin
{
    public IPluginInfo Info => new MyPluginInfo();
    public SemVersion Version => (0, 1, 0);
    public long LoadPriority => 99;
    public IEnumerable<Dependency> Dependencies
        => new List<Dependency>();

    public bool Initialize(ISubbleHost host)
    {
        _host = host;

        host.Events
            .Where(e => e.Type == EventsType.Core.LOG)
            .Subscribe(OnNewLogEntry);
    }

    private ISubbleHost _host;
    private int _count = 0;
    private void OnNewLogEntry(ISubbleEvent e)
    {
        _count++;
        if(_count == 10)
        {
            _host.EmitEvent("ON_LOG_MILESTONE", "LogCountPlugin", "Log count has reached 10!")
        }
    }
}
```
